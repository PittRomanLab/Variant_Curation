The following R code files is for the 1) evaluation of in silico prediction algorithm tools, 2) training/evaluating machine learning algorithms for variant curation, and 3) classifying variants, and 4) calculating summed allele frequency of pathogenic variants, lifetime risk, and 95% confidence intervals.  Instructions for how to use R functions described in Anzell et al. 2024 (Predicting the prevalence of Hereditary Hemorrhagic Telangiectasia using gnomAD v4.1). A reference set with known pathogenic and benign variant is required.

The following steps are for in silico pathogenicity prediction algorithm evaluation and training a machine learning model on a reference set:

Step 1: Open the 'InSilicoAlgorithmEvalR' file in Rstudio. Step 2: Install 9 libraries (1) caret (2) caretEnsemble, (3) dpylr (4) randomForest, (5) factoextra, (6) pROC, (7) plotROC, (8) ROSE, and (9) splitstackshape. To install libraries, either go to the 'Tools' lab and select 'Install Packages' and type in the desired packages, or use the install.packages() command. If you forget to install, the console should prompt you to install before it runs the code. Step 3: Load your test set for evaluation, in our case this is our Ensemble VEP output for ClinVar data. IMPORTANTE NOTE: Input file must be .csv Step 4: Convert your reference column and the in silico pathogenicity prediction algorithm columns your looking to evaluate to 1’s and 0’s. 1 = pathogenic, 2 = benign. IMPORTANT NOTE: Some algorithms will give you their prediction, while others will only give you a score. In the case of receiving a score, you will need to employ a cutoff for what scores are considered pathogenic and which are benign. This may vary depending on what type of variants and what gene you are looking at. Step 5: Perform confusion matrixes to assess accuracy metrics. Step 6: Open the ’TrainTestMachineLearning’ file in Rstudio. Step 7: Set 'Columns' equal to the columns within your spreadsheet you want included in the model. IMPORTANT NOTE: Do not change the anything other than the numbers in line 51 and 52. The ':' indicates 'through' so (2:22) = (2 through 22) IMPORTANT NOTE: Columns of interest must be numerical. Step 8: Set 'VC' equal to the column number for the reference variable. If 'Classification' is the reference variable and it is located in column 22, then set VC = 22. Make sure your VC is a factor. Step 9: Create 80:20% data partition to create a trainset and a testset, respectively. Step 10: Train and evaluate different machine learning models.  

Test Accuracy and Confusion Matrix will appear in the console, while PCA and Variable Importance will appear in the lower right hand side under 'plots'. Only one plot will appear at once, toggle arrows to see other plot

When satisfied with model performance, save and export needed objects in the enviorment/workspace

The following steps are for analyzing experimental data (unknown variants) after model training:

Step 11: Open 'PredictVariants' file in Rstudio. Step 12: Set 'ExperimentColumns' equal to the columns you'd like to analyze Same syntax as before, ':' reads as through IMPORTANT NOTE: Column names must be identical to those used in model training. Step 13: Set 'Model' equal to whatever you named your model in Step 10. Step 14: Run code to classify variants. Step 15: Join the classification data to the gnomAD data using the ‘uploaded_variation’ column as described in the code. Step 16: export data for further analysis.   

The following steps are for calculating total allele frequency, lifetime risk, and 95% confidence intervals:

Step 17: Open the 'CalculateCI' file in Rstudio. Step 18: Upload CSV of predicted pathogenic variants. Step 19: Ensure dataframe (df) and columns for allele count/allele numbers are inputted correctly. Step 20: Run script.
